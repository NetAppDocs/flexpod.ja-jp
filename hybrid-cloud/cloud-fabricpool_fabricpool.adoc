---
sidebar: sidebar 
permalink: hybrid-cloud/cloud-fabricpool_fabricpool.html 
keywords: flexpod, cloud, fabricpool, overview, hybrid, storage, solution sdd, performance 
summary: FabricPool は、オールフラッシュ（ SSD ）アグリゲートをパフォーマンス階層として使用し、オブジェクトストアをパブリッククラウドサービスにクラウド階層として使用する、 ONTAP のハイブリッドストレージ解決策です。この構成では、アクセス頻度に応じてポリシーベースのデータ移動が可能です。 
---
= FabricPool
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/




== FabricPool の概要

FabricPool は、オールフラッシュ（ SSD ）アグリゲートをパフォーマンス階層として使用し、オブジェクトストアをパブリッククラウドサービスにクラウド階層として使用する、 ONTAP のハイブリッドストレージ解決策です。この構成では、アクセス頻度に応じてポリシーベースのデータ移動が可能です。FabricPool は、 FAS プラットフォームの AFF アグリゲートとオール SSD アグリゲートの両方で ONTAP でサポートされています。データ処理はブロックレベルで実行され、アクセス頻度が高いデータブロックがオールフラッシュのパフォーマンス階層にあり、コールドとしてタグ付けされ、アクセス頻度が低いブロックとホットタグ付けされます。

FabricPool を使用すると、パフォーマンス、効率、セキュリティ、保護を犠牲にすることなくストレージコストを削減できます。FabricPool は、エンタープライズアプリケーションに対して透過的であり、アプリケーションインフラを再設計することなくストレージの TCO を削減することで、クラウドの効率性を活用します。

FlexPod は、 FabricPool のストレージ階層化機能を活用して、 ONTAP フラッシュストレージをより効率的に使用できます。NetApp SnapCenter for vSphere からアクセス頻度の低い仮想マシン（ VM ）、使用頻度の低い VM テンプレート、および VM のバックアップを取得すると、データストアボリュームのスペースを貴重に使用することができます。コールドデータをクラウド階層に移動することで、 FlexPod インフラにホストされているミッションクリティカルなハイパフォーマンスアプリケーションのスペースとリソースを解放できます。


NOTE: 一般に、 Fibre Channel および iSCSI プロトコルは、タイムアウト（ 60 ～ 120 秒）が発生するまでに時間がかかりますが、 NAS プロトコルと同じ方法で接続の確立を再試行することはありません。SAN プロトコルがタイムアウトした場合は、アプリケーションを再起動する必要があります。パブリッククラウドへの接続を保証する方法がないため、 SAN プロトコルを使用した本番アプリケーションの停止は、短時間であっても非常に深刻な事態になる可能性があります。この問題を回避するには、 SAN プロトコルがアクセスするデータを階層化するときにプライベートクラウドを使用することを推奨します。

ONTAP 9.6 で FabricPool は、 Alibaba Cloud Object Storage Service 、 Amazon AWS S3 、 Google Cloud Storage 、 IBM Cloud Object Storage 、 Microsoft Azure Blob Storage など、主要なすべてのパブリッククラウドプロバイダと統合されます。本レポートでは、選択するクラウドオブジェクト階層として Amazon AWS S3 ストレージを中心に説明します。



== 複合アグリゲート

ONTAP インスタンスを作成するには、 FabricPool フラッシュアグリゲートを AWS S3 バケットなどのクラウドオブジェクトストアに関連付けて複合アグリゲートを作成します。ボリュームを複数のアグリゲート内に作成すると、 FabricPool の階層化機能を利用できます。データがボリュームに書き込まれると、 ONTAP は各データブロックに温度を割り当てます。最初に書き込まれたブロックには、ホットの温度が割り当てられます。時間が経過すると、データにアクセスできない場合は、最後にコールドステータスが割り当てられるまでクーリングプロセスが実行されます。アクセス頻度の低いデータブロックは、パフォーマンス SSD アグリゲートからクラウドオブジェクトストアに階層化されます。

ブロックがコールドとして指定され、クラウドオブジェクトストレージに移動されるまでの期間は、 ONTAP のボリューム階層化ポリシーによって変更されます。さらにきめ細かい設定は、ブロックがコールドになるまでに必要な日数を制御する ONTAP 設定を変更することで実現します。データ階層化の対象となるのは、従来のボリューム Snapshot 、 vSphere VM バックアップ用の SnapCenter 、およびその他の NetApp Snapshot ベースのバックアップです。また、 VM テンプレートやアクセス頻度の低い VM データなど、 vSphere データストア内の使用頻度の低いブロックも対象となります。



=== Inactive Data Reporting の実行

ONTAP では、アグリゲートから階層化できるコールドデータの量を評価するのに役立つ Inactive Data Reporting （ IDR ）を利用できます。ONTAP 9.6 では、 IDR がデフォルトで有効になっており、 31 日間のデフォルトのクーリングポリシーを使用してアクセス頻度の低いデータが特定されます。


NOTE: 階層化されるコールドデータの量は、ボリュームに設定されている階層化ポリシーによって異なります。この量は、デフォルトの 31 日間のクーリング期間を使用して、 IDR によって検出されたコールドデータの量とは異なる場合があります。



== オブジェクトの作成とデータの移動

FabricPool は、 NetApp WAFL のブロックレベルで動作し、ブロックを冷却し、ストレージオブジェクトに連結し、それらのオブジェクトをクラウド階層に移行します。各 FabricPool オブジェクトは 4MB で、 1 、 024 個の 4KB ブロックで構成されています。オブジェクトサイズは、主要なクラウドプロバイダからの推奨パフォーマンスに基づいて、 4MB に固定されており、変更できません。コールドブロックが読み取られてホットにされると、 4MB オブジェクト内の要求されたブロックのみが取得され、パフォーマンス階層に戻されます。オブジェクト全体もファイル全体も移行されません。必要なブロックのみが移行されます。


NOTE: ONTAP は、シーケンシャルな先読みの機会を検出すると、パフォーマンスを向上させるために、読み取り前にブロックをクラウド階層に要求します。

デフォルトでは、パフォーマンスアグリゲートの使用率が 50% を超えている場合にのみ、データがクラウド階層に移動されます。このしきい値を低い割合に設定すると、パフォーマンスフラッシュ階層のデータストレージの量を少なくしてクラウドに移動できます。これは、アグリゲートの容量が上限に近づいている場合にのみコールドデータを移動する階層化戦略がある場合に役立ちます。

パフォーマンス階層の使用率が 70% を超える場合、コールドデータはパフォーマンス階層に書き戻されることなく、クラウド階層から直接読み取られます。FabricPool では、使用頻度の高いアグリゲートでのコールドデータの書き戻しを防止することで、アクティブデータのアグリゲートが保持されます。



== パフォーマンス階層のスペースを再生します

前述したように、 FabricPool の主なユースケースは、ハイパフォーマンスのオンプレミスフラッシュストレージを最も効率的に使用できるようにすることです。FlexPod 仮想インフラのボリューム Snapshot および VM バックアップという形で作成されたコールドデータは、高価なフラッシュストレージを大量に消費している可能性があります。Snapshot のみまたは自動の 2 つの階層化ポリシーのいずれかを実装すると、重要なパフォーマンス階層のストレージを解放できます。



=== snapshot-only 階層化ポリシー

次の図に示す「 Snapshot のみ」の階層化ポリシーは、ボリュームのコールドスナップショットデータと、スペースを占有しているがアクティブなファイルシステムとブロックを共有していない VM の SnapCenter for vSphere バックアップをクラウドオブジェクトストアに移動します。「 Snapshot のみ」の階層化ポリシーは、コールドデータブロックをクラウド階層に移動します。リストアが必要な場合、クラウド内のコールドブロックがホットになり、オンプレミスのパフォーマンスフラッシュ階層に戻ります。

image:cloud-fabricpool_image4.png["エラー：グラフィックイメージがありません"]



=== auto 階層化ポリシー

次の図に示す FabricPool の自動階層化ポリシーは、コールドスナップショットのデータブロックをクラウドに移動するだけでなく、アクティブファイルシステムのコールドブロックも移動します。これには、 VM テンプレートと、データストアボリューム内の未使用の VM データが含まれることがあります。どのコールドブロックを移動するかは ' ボリュームの階層化最小冷却日数設定によって制御されますクラウド階層のコールドブロックがアプリケーションによってランダムに読み取られると、それらのブロックがホットになり、パフォーマンス階層に戻ります。ただし、ウィルス対策スキャナなどのプロセスによってコールドブロックが読み取られた場合、ブロックはコールドのままクラウドオブジェクトストアに残り、パフォーマンス階層に戻されることはありません。

auto 階層化ポリシーを使用している場合、ホットに設定されたアクセス頻度の低いブロックは、クラウド接続の速度でクラウド階層から戻されます。これは、レイテンシの影響を受けやすいアプリケーションの場合、 VM のパフォーマンスに影響を及ぼす可能性があります。レイテンシが影響を受ける場合は、データストアで自動階層化ポリシーを使用する前に考慮する必要があります。十分なパフォーマンスを確保するために、インタークラスタ LIF は 10GbE の速度のポートに配置することを推奨します。


NOTE: オブジェクトストレージプロファイラは、オブジェクトストアを FabricPool アグリゲートに接続する前に、オブジェクトストアに対するレイテンシとスループットをテストするために使用します。

image:cloud-fabricpool_image5.png["エラー：グラフィックイメージがありません"]



=== all 階層化ポリシー

「自動」および「 Snapshot のみ」のポリシーとは異なり、「すべて」の階層化ポリシーは、データボリューム全体をただちにクラウド階層に移動します。このポリシーは、セカンダリデータ保護ボリュームまたはアーカイブボリュームに適しています。アーカイブボリュームのデータは、履歴データや規制上の目的で保持する必要があり、ほとんどアクセスされません。VMware データストアボリュームに書き込まれたデータはすぐにクラウド階層に移動されるため、「すべて」のポリシーは推奨されません。以降の読み取り処理はクラウドから実行されるため、データストアボリュームに配置されている VM やアプリケーションでパフォーマンスの問題が発生する可能性があります。



== セキュリティ

クラウドと FabricPool では、セキュリティが一元的に懸念されます。ONTAP に標準で搭載されているセキュリティ機能はすべて高パフォーマンス階層でサポートされており、データの移動はクラウド階層に転送される際にセキュリティで保護されます。FabricPool では、を使用します https://tools.ietf.org/html/rfc5288["AES-256-GCM"^] パフォーマンス階層で暗号化アルゴリズムを使用して、この暗号化をエンドツーエンドでクラウド階層に維持します。クラウドオブジェクトストアに移動されるデータブロックは、ストレージ階層間のデータの機密性と整合性を維持するために、 Transport Layer Security （ TLS ） v1.2 で保護されます。


NOTE: 暗号化されていない接続を介したクラウドオブジェクトストアとの通信はサポートされていますが、ネットアップでは推奨していません



=== データ暗号化

データ暗号化は、知的財産、取引情報、個人を特定できる顧客情報の保護に不可欠です。FabricPool は、既存のデータ保護戦略を維持するために、 NetApp Volume Encryption （ NVE ）と NetApp Storage Encryption （ NSE ）の両方を完全にサポートしています。クラウド階層に移動した場合、パフォーマンス階層で暗号化されたすべてのデータは暗号化されたままになります。クライアント側の暗号化キーは ONTAP によって所有され、サーバ側のオブジェクトストアの暗号化キーはそれぞれのクラウドオブジェクトストアによって所有されます。NVE で暗号化されていないデータは、 AES-256-GCM アルゴリズムで暗号化されます。それ以外の AES-256 暗号はサポートされません。


NOTE: NSE または NVE の使用はオプションで、 FabricPool を使用する必要はありません。
